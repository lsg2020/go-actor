// Code generated by protoc-gen-gactor. DO NOT EDIT.
// source: hello.proto

package hello

import (
	context "context"
	gactor "github.com/lsg2020/gactor"
	proto "google.golang.org/protobuf/proto"
)

// HelloServiceInterface is the server API for HelloService service.
type HelloServiceInterface interface {
	// onlysend;test send protocol
	OnSend(*gactor.DispatchMessage, *Request) *gactor.ActorError
	OnAdd(*gactor.DispatchMessage, *Request) (*Response, *gactor.ActorError)
	OnTestCallAdd(*gactor.DispatchMessage, *Request) (*Response, *gactor.ActorError)
}

func RegisterHelloService(s HelloServiceInterface, proto gactor.Proto) {
	reg := &HelloServiceProto{s: s}
	reg.register(proto)
}
func NewHelloServiceClient(proto gactor.Proto) *HelloServiceClient {
	client := &HelloServiceClient{Proto: proto}
	return client
}

type HelloServiceProto struct {
	s HelloServiceInterface
}

func (s *HelloServiceProto) register(p gactor.Proto) {
	p.Register(
		"HelloService.Send",
		func(ctx *gactor.DispatchMessage, args ...interface{}) {
			err := s.s.OnSend(ctx, args[0].(*Request))
			if err != nil {
				ctx.System.Logger().Errorf("message process error:%#v", err.Error())
			}
		},
		func() proto.Message { return new(Request) },
		func() proto.Message { return new(Empty) },
	)

	p.Register(
		"HelloService.Add",
		func(ctx *gactor.DispatchMessage, args ...interface{}) {
			rsp, err := s.s.OnAdd(ctx, args[0].(*Request))

			if err != nil {
				ctx.Response(err, nil)
			} else {
				ctx.Response(nil, rsp)
			}
		},
		func() proto.Message { return new(Request) },
		func() proto.Message { return new(Response) },
	)

	p.Register(
		"HelloService.TestCallAdd",
		func(ctx *gactor.DispatchMessage, args ...interface{}) {
			rsp, err := s.s.OnTestCallAdd(ctx, args[0].(*Request))

			if err != nil {
				ctx.Response(err, nil)
			} else {
				ctx.Response(nil, rsp)
			}
		},
		func() proto.Message { return new(Request) },
		func() proto.Message { return new(Response) },
	)

}

type HelloServiceClient struct {
	Proto gactor.Proto
}

func (client *HelloServiceClient) Send(system *gactor.ActorSystem, actor gactor.Actor, dest *gactor.ActorAddr, req *Request, options *gactor.CallOptions) *gactor.ActorError {
	err := actor.SendProto(system, dest, client.Proto.Id(), options, "HelloService.Send", req)

	return err
}

func (client *HelloServiceClient) Add(ctx context.Context, system *gactor.ActorSystem, actor gactor.Actor, dest *gactor.ActorAddr, req *Request, options *gactor.CallOptions) (*Response, *gactor.ActorError) {
	rsp, err := actor.CallProto(ctx, system, dest, client.Proto.Id(), options, "HelloService.Add", req)

	if err != nil {
		return nil, err
	}
	return rsp[0].(*Response), nil
}

func (client *HelloServiceClient) TestCallAdd(ctx context.Context, system *gactor.ActorSystem, actor gactor.Actor, dest *gactor.ActorAddr, req *Request, options *gactor.CallOptions) (*Response, *gactor.ActorError) {
	rsp, err := actor.CallProto(ctx, system, dest, client.Proto.Id(), options, "HelloService.TestCallAdd", req)

	if err != nil {
		return nil, err
	}
	return rsp[0].(*Response), nil
}
